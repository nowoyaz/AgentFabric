# Документация проекта AgentFabric

## Оглавление
1. [Развертывание проекта](#развертывание-проекта)
2. [Структура проекта](#структура-проекта)
3. [Настройка агента](#настройка-агента)
4. [Методы класса LangChainAgent](#методы-класса-langchainagent)
5. [Настройка агента](#тонкая-настройка-агента)

## Развертывание проекта

1. Клонируйте репозиторий или создайте новую директорию для проекта.

2. Создайте виртуальное окружение:
   ```
   python -m venv venv
   ```

3. Активируйте виртуальное окружение:
   - На Windows:
     ```
     venv\Scripts\activate
     ```
   - На macOS и Linux:
     ```
     source venv/bin/activate
     ```

4. Установите необходимые зависимости:
   ```
   pip install -r requirements.txt
   ```

5. Создайте файл `.env` в корневой директории проекта и добавьте в него ваш API ключ OpenAI:
   ```
   OPENAI_API_KEY=ваш_api_ключ_здесь
   ```

6. Подготовьте ваши CSV файлы с данными и поместите их в директорию `data/`.

7. Запустите проект:
   ```
   python run.py
   ```

## Структура проекта

```
.
├── data/
│   └── motor_data.csv
├── venv/
├── AgentFabric/
│   ├── __init__.py
│   ├── agent.py
│   └── factory.py
├── .env
├── requirements.txt
└── run.py
```

## Настройка агента

Настройка агента производится в файле `run.py`. Вот основные параметры, которые вы можете настроить:

- `source_columns`: словарь, определяющий столбец-источник для каждого CSV файла.
- `tool_data`: словарь с описанием каждого инструмента (tool).
- `tool_system_prompts`: словарь с системными промптами для каждого инструмента.
- `file_paths`: список путей к CSV файлам с данными.
- `system_prompt`: общий системный промпт для агента.
- `model_name`: название модели OpenAI для использования (например, "gpt-4o").



## Пояснение

### 1. source_columns
```python
source_columns = {
    "motor_data": "model",
}
```
- Это словарь, который определяет, какой столбец в каждом CSV файле содержит основные данные.
- Ключ ("motor_data") соответствует имени файла без расширения.
- Значение ("model") указывает на столбец в CSV файле, который содержит ключевую информацию.
- Если у вас несколько CSV файлов, добавьте соответствующие пары ключ-значение.

### 2. tool_data
```python
tool_data = {
    "motor_data": "Tool for retrieving motor data based on model",
}
```
- Этот словарь предоставляет описание для каждого инструмента (tool).
- Ключ должен соответствовать имени файла данных.
- Значение - это описание инструмента, которое поможет агенту понять, когда использовать этот инструмент.

### 3. tool_system_prompts
```python
tool_system_prompts = {
    "motor_data": "You are an expert in motor specifications. Provide accurate and detailed information about motors when asked."
}
```
- Этот словарь содержит системные промпты для каждого инструмента.
- Ключ соответствует имени файла данных.
- Значение - это инструкция, которая определяет, как инструмент должен отвечать на запросы.

### 4. file_paths
```python
file_paths = [
    "./data/motor_data.csv",
]
```
- Это список путей к CSV файлам с данными.
- Каждый путь должен указывать на соответствующий CSV файл.
- Убедитесь, что имена файлов (без расширения) соответствуют ключам в `source_columns` и `tool_data`.

### 5. system_prompt
```python
system_prompt = "You are a very powerful assistant, but don't know current events"
```
- Это общий системный промпт для всего агента.
- Он определяет общее поведение и характер агента.
- Можно настроить под конкретные задачи или области знаний.

### Передача истории чата

История чата передается при вызове метода `run_agent`. Вот как это работает:

```python
initial_chat_history = ["Меня зовут Олег", "Привет"]
response, updated_chat_history = agent.run_agent("Как меня зовут?", initial_chat_history)
```

- `initial_chat_history` - это начальная история чата. Это список строк, где четные индексы (0, 2, 4, ...) - сообщения пользователя, а нечетные (1, 3, 5, ...) - ответы агента.
- Метод `run_agent` принимает вопрос и текущую историю чата.
- Он возвращает ответ на вопрос и обновленную историю чата.

Для продолжения диалога используйте обновленную историю чата в следующем вызове:

```python
next_question = "Расскажи мне о моторах"
response, updated_chat_history = agent.run_agent(next_question, updated_chat_history)
```

Это позволяет агенту сохранять контекст разговора между вопросами.

"# AgentFabric" 
